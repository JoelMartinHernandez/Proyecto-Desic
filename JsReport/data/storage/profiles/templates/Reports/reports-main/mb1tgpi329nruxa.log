{"type":"operationStart","subtype":"profile","data":{"_id":"eSt1VNLwX5R4cmAL","timestamp":"2024-01-12T15:25:33.322Z","state":"queued","mode":"standard","creationDate":"2024-01-12T15:25:33.326Z","modificationDate":"2024-01-12T15:25:33.326Z","shortid":"XlQkot3","$entitySet":"profiles"},"doDiffs":false,"timestamp":1705073133324,"id":"8fj4ycep0oqvbn3","previousOperationId":null,"operationId":"l9mvk00lc7gotxc"}
{"type":"log","level":"info","message":"Render request 8 queued for execution and waiting for available worker","previousOperationId":"l9mvk00lc7gotxc","timestamp":1705073133324,"id":"ojr5ldcy4g1td5j"}
{"type":"operationStart","subtype":"render","name":"reports-main","previousOperationId":"l9mvk00lc7gotxc","timestamp":1705073133346,"id":"zg7slrb0zq250wv","previousEventId":"8fj4ycep0oqvbn3","operationId":"wdr9n4e16u133om"}
{"type":"log","timestamp":1705073133347,"level":"info","message":"Starting rendering request 8","meta":{"rootId":"mb1tgpi329nruxa","id":"mb1tgpi329nruxa"},"id":"f8lf6pngudydkyg","previousOperationId":"wdr9n4e16u133om"}
{"type":"log","timestamp":1705073133349,"level":"info","message":"Rendering template { name: reports-main, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"mb1tgpi329nruxa","id":"mb1tgpi329nruxa"},"id":"h2szbqx0h7x6qwy","previousOperationId":"wdr9n4e16u133om"}
{"type":"log","timestamp":1705073133357,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"mb1tgpi329nruxa","id":"mb1tgpi329nruxa"},"id":"cl730i51boevkfy","previousOperationId":"wdr9n4e16u133om"}
{"type":"log","timestamp":1705073133365,"level":"debug","message":"Executing script reports-script (beforeRender)","meta":{"rootId":"mb1tgpi329nruxa","id":"mb1tgpi329nruxa"},"id":"4zagldibzgmjxky","previousOperationId":"wdr9n4e16u133om"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1705073134077,"id":"ggca7ijr2hpn7ky","previousEventId":"zg7slrb0zq250wv","operationId":"qf1wkol4lone00p","previousOperationId":"wdr9n4e16u133om"}
{"type":"operationStart","subtype":"script","name":"scripts reports-script","previousOperationId":"qf1wkol4lone00p","timestamp":1705073134077,"id":"hhvyswqcqrhwlqk","previousEventId":"ggca7ijr2hpn7ky","operationId":"9as78t8obwp6wf8"}
{"type":"log","timestamp":1705073134162,"level":"debug","message":"(console:log) [\n  {\n    id: 1,\n    number: 2,\n    firstStop: 'C',\n    lastStop: 'D',\n    createdAt: '2023-12-01T17:35:52.000Z',\n    updatedAt: '2023-12-12T20:01:36.000Z'\n  },\n  {\n    id: 2,\n    number: 66,\n    firstStop: 'TF',\n    lastStop: 'VG',\n    createdAt: '2023-12-01T19:20:40.000Z',\n    updatedAt: '2023-12-01T19:20:40.000Z'\n  },\n  {\n    id: 3,\n    number: 69,\n    firstStop: 'Si',\n    lastStop: 'No',\n    createdAt: '2023-12-04T17:13:35.000Z',\n    updatedAt: '2023-12-04T17:13:35.000Z'\n  },\n  {\n    id: 4,\n    number: 22,\n    firstStop: 'FG',\n    lastStop: 'DF',\n    createdAt: '2023-12-08T18:39:03.000Z',\n    updatedAt: '2023-12-08T18:39:03.000Z'\n  },\n  {\n    id: 5,\n    number: 1,\n    firstStop: 'A',\n    lastStop: 'B',\n    createdAt: '2023-12-12T19:54:23.000Z',\n    updatedAt: '2023-12-12T19:54:23.000Z'\n  }\n]","meta":{"userLevel":true,"rootId":"mb1tgpi329nruxa","id":"mb1tgpi329nruxa"},"id":"8wzpqor9jln2jg4","previousOperationId":"9as78t8obwp6wf8"}
{"type":"log","timestamp":1705073134172,"level":"warn","message":"Error when processing render request 8\n(because) error when evaluating custom script /templates/Reports/reports-script\nfetchBusstops is not defined\n\n(sandbox.js line 25:24)\n\n  23 |     req.data.lines = await fetchReport()\n  24 |     console.log(req.data.lines)\n> 25 |     req.data.busstops= await fetchBusstops()\n     |                        ^\n  26 |     console.log(req.data.busstops)\n  27 | }\n  28 |\n\n\nReferenceError: fetchBusstops is not defined\n    at Object.beforeRender (sandbox.js:25:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async executionFn (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:11)\n    at async run (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:137:16)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:14)\n    at async executeScript (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)\n    at async Scripts.handleBeforeRender (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:64:7)\n    at async ListenerCollection.fire (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\listenerCollection.js:157:21)\n    at async beforeRender (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:24:5)","meta":{"rootId":"mb1tgpi329nruxa","id":"mb1tgpi329nruxa"},"id":"tlxm1qjyxzb7z7f","previousOperationId":"9as78t8obwp6wf8"}
{"type":"log","timestamp":1705073134172,"level":"warn","message":"Rendering request 8 finished with error in 850 ms","meta":{"rootId":"mb1tgpi329nruxa","id":"mb1tgpi329nruxa"},"id":"tjplikxsi44cl6z","previousOperationId":"9as78t8obwp6wf8"}
{"type":"error","timestamp":1705073134185,"statusCode":400,"weak":true,"lineNumber":25,"decoratedSuffix":"\n\n(sandbox.js line 25:24)\n\n  23 |     req.data.lines = await fetchReport()\n  24 |     console.log(req.data.lines)\n> 25 |     req.data.busstops= await fetchBusstops()\n     |                        ^\n  26 |     console.log(req.data.busstops)\n  27 | }\n  28 |\n\n","entity":{"shortid":"vVn-6F0Ydc","name":"reports-script","content":"// server side script fetching remote data and preparing report data source\nconst axios = require('axios');\n\n// call remote http rest api\nfunction fetchReport() {\n    return new Promise((resolve, reject) => {\n        axios.get('http://localhost:8080/api/line').then(lines =>{\n            resolve(lines.data)\n        })\n    })\n}\n\nfunction fetchBusStops(){\n        return new Promise((resolve, reject) => {\n        axios.get('http://localhost:8080/api/bus_stop').then(busstops =>{\n            resolve(busstops.data)\n        })\n    })\n}\n\n// add jsreport hook which modifies the report input data\nasync function beforeRender(req, res) {\n    req.data.lines = await fetchReport()\n    console.log(req.data.lines)\n    req.data.busstops= await fetchBusstops()\n    console.log(req.data.busstops)\n}\n\nasync function beforeRenderA(req, res) {\n    req.data.busstops= await fetchBusstops()\n    console.log(req.data.busstops)\n}"},"property":"content","logged":true,"previousOperationId":"9as78t8obwp6wf8","id":"yj8yr6yu9v34s4s","stack":"ReferenceError: fetchBusstops is not defined\n    at Object.beforeRender (sandbox.js:25:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async executionFn (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:11)\n    at async run (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:137:16)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:14)\n    at async executeScript (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)\n    at async Scripts.handleBeforeRender (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:64:7)\n    at async ListenerCollection.fire (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\listenerCollection.js:157:21)\n    at async beforeRender (C:\\Users\\ratha\\Desktop\\proyectoDesic\\JsReport\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:24:5)","message":"Error when evaluating custom script /templates/Reports/reports-script\nfetchBusstops is not defined\n\n(sandbox.js line 25:24)\n\n  23 |     req.data.lines = await fetchReport()\n  24 |     console.log(req.data.lines)\n> 25 |     req.data.busstops= await fetchBusstops()\n     |                        ^\n  26 |     console.log(req.data.busstops)\n  27 | }\n  28 |\n\n"}
